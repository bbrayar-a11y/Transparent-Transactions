<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Transparent Transactions</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéâ Welcome to Your Dashboard!</h1>
            <p class="tagline">Your account is active and ready</p>
        </header>

        <main>
            <div id="userInfo" style="background: white; padding: 25px; border-radius: 12px; margin: 20px 0;">
                <h3>Your Account Information</h3>
                <div id="userDetails">Loading...</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Account Status</h3>
                    <p class="stat-amount">‚úÖ Active</p>
                    <small>Ready to use</small>
                </div>
                <div class="stat-card">
                    <h3>Your Balance</h3>
                    <p class="stat-amount">‚Çπ0.00</p>
                    <small>Start transacting</small>
                </div>
                <div class="stat-card">
                    <h3>Trust Score</h3>
                    <p class="stat-amount">100%</p>
                    <small>New Member</small>
                </div>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button class="btn btn-primary" onclick="getReferralCode()" style="margin: 5px;">
                    üéØ Get My Referral Code
                </button>
                <button class="btn btn-secondary" onclick="goToHome()" style="margin: 5px;">
                    üè† Home
                </button>
                <button class="btn btn-logout" onclick="logout()" style="margin: 5px;">
                    üö™ Logout
                </button>
            </div>

            <div id="debugInfo" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 20px;">
                <h4>Debug Information</h4>
                <button class="btn btn-info" onclick="checkSession()" style="margin: 5px;">
                    üîç Check Session
                </button>
                <button class="btn btn-info" onclick="clearAndReset()" style="margin: 5px;">
                    üßπ Clear & Reset
                </button>
            </div>
        </main>
    </div>

    <script>
        // CHECK SESSION IMMEDIATELY on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Dashboard loaded - checking session...');
            const session = localStorage.getItem('currentUser');
            
            if (session) {
                console.log('‚úÖ Session found:', JSON.parse(session));
                loadUserInfo();
            } else {
                console.log('‚ùå No session found in dashboard');
                document.getElementById('userDetails').innerHTML = 
                    '<p style="color: red;">No user session found! Registration failed.</p>' +
                    '<button class="btn btn-primary" onclick="window.location.href=\'login.html\'">Go to Registration</button>';
            }
        });

        function loadUserInfo() {
            const session = localStorage.getItem('currentUser');
            if (session) {
                const user = JSON.parse(session);
                document.getElementById('userDetails').innerHTML = `
                    <p><strong>Name:</strong> ${user.fullName || 'Not set'}</p>
                    <p><strong>Phone:</strong> ${user.phone || 'Not set'}</p>
                    <p><strong>Email:</strong> ${user.email || 'Not set'}</p>
                    <p><strong>Member Since:</strong> ${new Date(user.registrationDate || Date.now()).toLocaleDateString()}</p>
                    <p><strong>Session Active:</strong> ‚úÖ Yes</p>
                `;
            }
        }

        function getReferralCode() {
            const session = localStorage.getItem('currentUser');
            if (session) {
                const user = JSON.parse(session);
                const code = `TT${(user.phone || '123456').slice(-6)}${Math.random().toString(36).substr(2, 3).toUpperCase()}`;
                alert(`üéâ Your Referral Code: ${code}\n\nShare this with friends to build your network!`);
            } else {
                alert('Please create an account first');
            }
        }

        function checkSession() {
            const session = localStorage.getItem('currentUser');
            if (session) {
                alert('‚úÖ Session is ACTIVE!\n\nUser: ' + JSON.parse(session).fullName);
                console.log('Current session:', JSON.parse(session));
            } else {
                alert('‚ùå No session found!');
            }
        }

        function goToHome() {
            window.location.href = 'index.html';
        }

        function logout() {
            localStorage.removeItem('currentUser');
            alert('Logged out successfully');
            window.location.href = 'index.html';
        }

        function clearAndReset() {
            localStorage.clear();
            alert('All data cleared. Page will reload.');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
