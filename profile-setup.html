<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Setup - Transparent Transactions</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/auth.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Transparent Transactions</h1>
            <p class="tagline">Complete Your Profile</p>
        </header>

        <main>
            <div class="auth-container">
                <section class="auth-section active">
                    <h3>Tell Us About Yourself</h3>
                    <p>Complete your profile to get started with Transparent Transactions</p>
                    
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input 
                            type="tel" 
                            id="phone" 
                            placeholder="+1 (555) 123-4567" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input 
                            type="text" 
                            id="address" 
                            placeholder="Street Address" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="city">City</label>
                        <input 
                            type="text" 
                            id="city" 
                            placeholder="City" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="country">Country</label>
                        <select id="country" class="form-input">
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="CA">Canada</option>
                            <option value="UK">United Kingdom</option>
                            <option value="AU">Australia</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="occupation">Occupation</label>
                        <input 
                            type="text" 
                            id="occupation" 
                            placeholder="Your Occupation" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="termsAgreement">
                            I agree to the <a href="https://bbrayar-a11y.github.io/Transparent-Transactions/terms.html" target="_blank">Terms of Service</a> and <a href="https://bbrayar-a11y.github.io/Transparent-Transactions/privacy.html" target="_blank">Privacy Policy</a>
                        </label>
                    </div>
                    
                    <button onclick="completeProfileSetup()" class="btn btn-primary">Complete Setup</button>
                    <div id="profileMessage" class="message"></div>
                </section>

                <div class="auth-links">
                    <p><a href="https://bbrayar-a11y.github.io/Transparent-Transactions/">‚Üê Back to Home</a></p>
                </div>
            </div>
        </main>
    </div>

    <script src="js/database.js"></script>
    <script src="js/auth.js"></script>
    <script>
        function completeProfileSetup() {
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const country = document.getElementById('country').value;
            const occupation = document.getElementById('occupation').value;
            const termsAgreed = document.getElementById('termsAgreement').checked;
            const message = document.getElementById('profileMessage');
            
            if (!phone || !address || !city || !country || !occupation) {
                message.textContent = 'Please fill in all required fields';
                message.className = 'message error';
                return;
            }
            
            if (!termsAgreed) {
                message.textContent = 'Please agree to the Terms of Service and Privacy Policy';
                message.className = 'message error';
                return;
            }
            
            // Get existing user data
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            
            // Update with profile data
            const updatedUser = {
                ...currentUser,
                phone,
                address,
                city,
                country,
                occupation,
                profileCompleted: true,
                profileCompletionDate: new Date().toISOString()
            };
            
            // Save updated user data
            localStorage.setItem('currentUser', JSON.stringify(updatedUser));
            
            // Save to users list
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const userExists = users.find(u => u.email === currentUser.email);
            
            if (!userExists) {
                users.push(updatedUser);
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            message.textContent = 'Profile completed successfully! Redirecting to dashboard...';
            message.className = 'message success';
            
            setTimeout(() => {
                window.location.href = 'https://bbrayar-a11y.github.io/Transparent-Transactions/dashboard.html';
            }, 2000);
        }

        // Check if user is logged in
        window.addEventListener('DOMContentLoaded', () => {
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                window.location.href = 'https://bbrayar-a11y.github.io/Transparent-Transactions/login.html';
            }
        });
    </script>
</body>
</html>
